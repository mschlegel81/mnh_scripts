IFS:=['IFS[qualityfactor:50;Color00:0.912973046302795,0.381803125143051,0.964792907238007;Color01:0.912973046302795,0.381803125143051,0.964792907238007;Color02:0.912973046302795,0.381803125143051,0.964792907238007;Color10:0.390940219163895,0.123632818460464,0.718650758266449;Color11:0.390940219163895,0.123632818460464,0.718650758266449;Color12:0.390940219163895,0.123632818460464,0.718650758266449;Color20:0.273729860782623,0.919070959091187,0.142546892166138;Color21:0.273729860782623,0.919070959091187,0.142546892166138;Color22:0.273729860782623,0.919070959091187,0.142546892166138;con00:-0.0230388049967587,0.864039012230933;lin000:-0.357228830225269,-0.326128785295824;lin100:-0.399122584276677,-0.623242591173405;sqr000:-0.0832906899429206,0.403233831541897;sqr100:0.349233082117821,-0.00559533921714337;con01:-0.0230388049967587,0.864039012230933;lin001:-0.357228830225269,-0.326128785295824;lin101:-0.399122584276677,-0.623242591173405;sqr001:-0.0832906899429206,0.403233831541897;sqr101:0.349233082117821,-0.00559533921714337;con02:-0.0230388049967587,0.864039012230933;lin002:-0.357228830225269,-0.326128785295824;lin102:-0.399122584276677,-0.623242591173405;sqr002:-0.0832906899429206,0.403233831541897;sqr102:0.349233082117821,-0.00559533921714337;con10:-0.773089345544577,0.307660599704832;lin010:-0.0855119338972938,0.464651589293821;lin110:0.178858436475162,0.375000245475423;sqr010:-0.413734431064436,0.0258905736105806;sqr110:0.387382631648983,-0.411277474274321;con11:-0.773089345544577,0.307660599704832;lin011:-0.0855119338972938,0.464651589293821;lin111:0.178858436475162,0.375000245475423;sqr011:-0.413734431064436,0.0258905736105806;sqr111:0.387382631648983,-0.411277474274321;con12:-0.773089345544577,0.307660599704832;lin012:-0.0855119338972938,0.464651589293821;lin112:0.178858436475162,0.375000245475423;sqr012:-0.413734431064436,0.0258905736105806;sqr112:0.387382631648983,-0.411277474274321;con20:0.320800950750709,0.668030674569309;lin020:0.552924153293107,-0.100759681140129;lin120:-0.0794878657418409,0.393295797616569;sqr020:0.159638355674892,0.473771957894425;sqr120:-0.59335613675869,-0.271164060067325;con21:0.320800950750709,0.668030674569309;lin021:0.552924153293107,-0.100759681140129;lin121:-0.0794878657418409,0.393295797616569;sqr021:0.159638355674892,0.473771957894425;sqr121:-0.59335613675869,-0.271164060067325;con22:0.320800950750709,0.668030674569309;lin022:0.552924153293107,-0.100759681140129;lin122:-0.0794878657418409,0.393295797616569;sqr022:0.159638355674892,0.473771957894425;sqr122:-0.59335613675869,-0.271164060067325]',
      'IFS[qualityfactor:50;Color00:0.435584992170334,0.916515171527863,0.47995513677597;Color01:0.996672868728638,0.186913132667542,0.91107302904129;Color02:0.063597559928894,0.319713920354843,0.912433803081512;Color10:0.768716931343079,0.932184159755707,0.528639316558838;Color11:0.980705142021179,0.995851993560791,0.410457223653793;Color12:0.268346756696701,0.648166298866272,0.170863509178162;Color20:0.814638435840607,0.200214773416519,0.771090090274811;Color21:0.336426913738251,0.661617577075958,0.0789225250482559;Color22:0.82303386926651,0.242855429649353,0.956961274147034;con00:-0.117723690345883,0.569046264048666;lin000:-0.364405662102699,0.044259965383957;lin100:-0.376250186659176,0.64381758646909;sqr000:-0.59156316504201,0.426338537320034;sqr100:0.558859133218248,0.363284858862783;con01:-0.573640442453325,-0.161230675410479;lin001:-0.651867139967745,0.424082827451019;lin101:0.0779721807756922,0.436689089452063;sqr001:-0.129310185165625,0.600078636145885;sqr101:-0.081780360589983,-0.697976572613905;con02:-0.814554674550891,0.389177335426211;lin002:0.347199231283734,-0.261327208542198;lin102:-0.296191955518971,-0.427939622337978;sqr002:-0.617551662245295,-0.623363268795949;sqr102:0.021944091217807,-0.0785074674837493;con10:0.16721405275166,-0.461999906692654;lin010:0.547060497030903,-0.0613141364321371;lin110:0.356620446723187,0.441686619745561;sqr010:0.596334631164625,0.284661192188417;sqr110:-0.243711811047063,-0.128019153438752;con11:-0.966154475696385,-0.00651919050142169;lin011:0.279491806473754,0.444776917557522;lin111:0.116866078554415,0.114400259401584;sqr011:0.685850553866035,-0.241184437080526;sqr111:-0.255850428739188,0.394667585339368;con12:0.678791362792253,-0.653404747601599;lin012:0.564538071367957,0.558280956494203;lin112:-0.0231383014262112,0.340413833652037;sqr012:0.241321332678668,0.643969467906055;sqr112:0.0187734980618046,0.471541250984744;con20:-0.315647095441818,-0.171599415130913;lin020:-0.70347479528464,0.206302819839819;lin120:-0.574704704531252,0.343520581905807;sqr020:-0.354261543917587,0.302802252422169;sqr120:-0.494030573920496,-0.4911781295432;con21:0.564901427365839,-0.629648595117033;lin021:0.517110277397842,0.129043773289827;lin121:0.357261845695632,-0.678328391785331;sqr021:0.509015306389377,0.62717220099734;sqr121:0.204018235428307,-0.465259323141746;con22:-0.725151269696653,-0.353846811223775;lin022:-0.463185177286304,0.359390200300793;lin122:0.0919376012622329,-0.0369178092005201;sqr022:-0.161322633961984,-0.705368213148761;sqr122:0.262408320646073,-0.241932133039094]',
      'IFS[qualityfactor:50;Color00:0.857946276664734,0.776247382164001,0.58924800157547;Color01:0.970703542232513,0.454345136880875,0.315889567136765;Color02:0.685766220092773,0.835394859313965,0.896152019500732;Color10:0.972637176513672,0.458950906991959,0.502814292907715;Color11:0.275059729814529,0.871819078922272,0.509479522705078;Color12:0.12263560295105,0.654697716236115,0.142763495445251;Color20:0.992434978485107,0.208508193492889,0.111654579639435;Color21:0.878959953784943,0.143287524580956,0.695184588432312;Color22:0.360297173261642,0.103368163108826,0.456090360879898;con00:0.608027221169323,0.954361457377672;lin000:0.561698646415584,0.100377258417443;lin100:0.320478364757489,0.168188628551108;sqr000:0.513477670817735,-0.49556153283869;sqr100:-0.562861942239878,0.296160136953252;con01:-0.545693186111748,-0.618135220836848;lin001:0.148922947165655,-0.6617296187524;lin101:0.68315331361202,0.371426681032452;sqr001:0.173624203882798,0.665107584939788;sqr101:-0.419843770855505,0.116457508651312;con02:0.365754248574376,-0.346531244460493;lin002:0.304144062869691,-0.207524650392705;lin102:0.536093262089631,0.405623233848567;sqr002:-0.270110377000751,0.241840678329092;sqr102:0.2747433136763,0.0376984916534926;con10:-0.041412366554141,-0.478191954083741;lin010:0.058868447009281,-0.343944178806766;lin110:-0.572179428358245,0.296548786214261;sqr010:-0.39566939090378,0.431044168089641;sqr110:0.35431731045434,0.251796778105908;con11:0.576783819589764,0.217046769335866;lin011:-0.602849501675893,-0.345199504908961;lin111:0.534600341690034,0.0421050506909724;sqr011:0.0916163178116679,0.266868120702118;sqr111:-0.323165286277608,0.172768746664394;con12:-0.716322353109717,0.139650426339358;lin012:-0.0527534878579254,0.347850358275651;lin112:0.246965955061883,0.572925410125458;sqr012:0.238979304088269,-0.297801413601062;sqr112:0.0776630293613255,-0.246990968887202;con20:-0.4567357795313,-0.0977808330208063;lin020:-0.573684687247743,-0.0145255912866487;lin120:0.0913508575326833,0.20374359635597;sqr020:0.359299842725941,-0.191764111334388;sqr120:-0.171192381431646,-0.519550096225682;con21:0.305346457287669,0.592377819120884;lin021:0.622623133257605,0.642435625550732;lin121:-0.612918842790668,-0.597844281558175;sqr021:0.161540103797767,0.535858128773056;sqr121:-0.405848794562174,0.706351585393851;con22:0.784036518074572,0.194300224073231;lin022:0.207356740970232,-0.213560631618307;lin122:0.458412298256447,-0.515134248417917;sqr022:0.18053075855744,0.381461409047887;sqr122:0.633359381078524,0.037355588845275]',
      'IFS[qualityfactor:50;Color00:0.361523687839508,0.984582543373108,0.576124906539917;Color01:0.758500397205353,0.36719611287117,0.580757737159729;Color02:0.736970782279968,0.947219967842102,0.884825468063354;Color10:0.758500397205353,0.36719611287117,0.580757737159729;Color11:0.736970782279968,0.947219967842102,0.884825468063354;Color12:0.361523687839508,0.984582543373108,0.576124906539917;Color20:0.736970782279968,0.947219967842102,0.884825468063354;Color21:0.361523687839508,0.984582543373108,0.576124906539917;Color22:0.758500397205353,0.36719611287117,0.580757737159729;con00:0.882947569247335,0.190432677976787;lin000:0.556323200478013,0.51175879655346;lin100:-0.0645605092924898,0.482487024948319;sqr000:0.175595976031023,0.505747249963282;sqr100:0.314111805054864,-0.402827422652597;con01:-0.471100250259042,-0.0178851773962379;lin001:-0.647631457095747,0.0405004203986697;lin101:-0.513863246322254,0.320977857925176;sqr001:-0.567872362225031,0.248169907777738;sqr101:-0.185352667872277,-0.346356668037524;con02:0.217644717078656,-0.921844602562487;lin002:-0.257095355435785,0.341109505253018;lin102:-0.229967342779663,-0.612726414109802;sqr002:-0.10502718587057,-0.136587908695857;sqr102:0.0596446503717825,0.394125034226843;con10:-0.471100250259042,-0.0178851773962379;lin010:-0.647631457095747,0.0405004203986697;lin110:-0.513863246322254,0.320977857925176;sqr010:-0.567872362225031,0.248169907777738;sqr110:-0.185352667872277,-0.346356668037524;con11:0.217644717078656,-0.921844602562487;lin011:-0.257095355435785,0.341109505253018;lin111:-0.229967342779663,-0.612726414109802;sqr011:-0.10502718587057,-0.136587908695857;sqr111:0.0596446503717825,0.394125034226843;con12:0.882947569247335,0.190432677976787;lin012:0.556323200478013,0.51175879655346;lin112:-0.0645605092924898,0.482487024948319;sqr012:0.175595976031023,0.505747249963282;sqr112:0.314111805054864,-0.402827422652597;con20:0.217644717078656,-0.921844602562487;lin020:-0.257095355435785,0.341109505253018;lin120:-0.229967342779663,-0.612726414109802;sqr020:-0.10502718587057,-0.136587908695857;sqr120:0.0596446503717825,0.394125034226843;con21:0.882947569247335,0.190432677976787;lin021:0.556323200478013,0.51175879655346;lin121:-0.0645605092924898,0.482487024948319;sqr021:0.175595976031023,0.505747249963282;sqr121:0.314111805054864,-0.402827422652597;con22:-0.471100250259042,-0.0178851773962379;lin022:-0.647631457095747,0.0405004203986697;lin122:-0.513863246322254,0.320977857925176;sqr022:-0.567872362225031,0.248169907777738;sqr122:-0.185352667872277,-0.346356668037524]',
      'IFS[qualityfactor:50;Color00:0.909513294696808,0.992027878761292,0.0513155497610569;Color01:0.325066953897476,0.2083790153265,0.941283762454987;Color02:0.809772551059723,0.187465250492096,0.0764094889163971;Color10:0.909513294696808,0.992027878761292,0.0513155497610569;Color11:0.35286608338356,0.755392670631409,0.862479865550995;Color12:0.854538798332214,0.0333311706781387,0.588302910327911;Color20:0.909513294696808,0.992027878761292,0.0513155497610569;Color21:0.561701774597168,0.655687153339386,0.669777870178223;Color22:0.550895571708679,0.388232976198196,0.957893252372742;con00:0.338928799144924,0.0887784278020263;lin000:-0.673522299392487,-0.629892958863552;lin100:-0.176572127006311,-0.595430789364131;sqr000:-0.165905693135043,0.260970604386219;sqr100:-0.149076836834097,0.0388195513964946;con01:-0.72722454695031,-0.865349379368126;lin001:-0.615521973412498,0.595059934305;lin101:-0.536798086142184,-0.554577485915225;sqr001:0.615829083997434,-0.323842447838832;sqr101:-0.454311918292697,-0.577361083744908;con02:-0.104944142047316,-0.214452784974128;lin002:0.634646579417817,0.660018517947497;lin102:-0.24629587581757,-0.192373519531725;sqr002:-0.355771414594275,0.14124788026982;sqr102:0.611707062944063,-0.605039233946287;con10:0.338928799144924,0.0887784278020263;lin010:-0.673522299392487,-0.629892958863552;lin110:-0.176572127006311,-0.595430789364131;sqr010:-0.165905693135043,0.260970604386219;sqr110:-0.149076836834097,0.0388195513964946;con11:-0.209020891692489,0.17024957947433;lin011:-0.307952342124203,0.00253650271050688;lin111:0.638244502434322,-0.486418643991547;sqr011:0.310219200163922,-0.661493644145216;sqr111:-0.106417257423089,-0.52030532725051;con12:0.445138997863978,-0.46620155358687;lin012:0.198285413191321,0.102410239643508;lin112:-0.280699700249217,-0.333144632346283;sqr012:0.521251392949222,0.43113738572329;sqr112:-0.328375962732922,0.565468090641916;con20:0.338928799144924,0.0887784278020263;lin020:-0.673522299392487,-0.629892958863552;lin120:-0.176572127006311,-0.595430789364131;sqr020:-0.165905693135043,0.260970604386219;sqr120:-0.149076836834097,0.0388195513964946;con21:0.958398480899632,0.318460083100945;lin021:0.344900535580505,0.0168783515183498;lin121:-0.324790156276819,-0.480669165846865;sqr021:0.698239512313786,-0.261101915197661;sqr121:-0.14474306902599,0.583381094607647;con22:-0.727530296891928,-0.727935133501887;lin022:0.0907898075756571,-0.502097258137437;lin122:-0.142687084181717,0.220031660516773;sqr022:0.580065746783345,-0.140324788884085;sqr122:0.501703722805451,0.087529088323198]',
      'IFS[qualityfactor:50;Color00:0.127184197306633,0.477624595165253,0.414718687534332;Color01:0.339497894048691,0.931802451610565,0.15936167538166;Color02:0.3854760825634,0.0311870947480202,0.752997159957886;Color10:0.505693256855011,0.0507736504077911,0.38954883813858;Color11:0.466558456420898,0.252752393484116,0.619122862815857;Color12:0.508499979972839,0.131436914205551,0.63746041059494;Color20:0.0418172664940357,0.593053460121155,0.113636173307896;Color21:0.70801967382431,0.577573657035828,0.849825918674469;Color22:0.469458937644959,0.888104796409607,0.326623886823654;con00:-0.532543597277254,-0.0773824146017432;lin000:0.42623408524635,-0.252287151749248;lin100:-0.198192938395877,-0.0684972893490273;sqr000:-0.439947706959725,-0.422781641626376;sqr100:0.688815815149355,0.603981801456557;con01:0.335793063044548,0.447197237517685;lin001:-0.462685314016603,0.0440945255033893;lin101:0.202734377885303,-0.602817241226808;sqr001:-0.488557653846847,-0.542555076633341;sqr101:-0.0641641359629466,-0.563089714016671;lin002:-0.0414754702875397,-0.557143429516506;lin102:-0.270506053590205,-0.295127186843423;sqr002:0.524407775373287,-0.487756098167149;sqr102:0.138250848823802,-0.298980218477791;con10:0.758713980671018,-0.250057356897742;lin010:0.611682357646846,-0.0390833834241832;lin110:0.617282239174733,-0.638920712728003;sqr010:0.560094150466361,0.0531493886817842;sqr110:0.288263625246984,-0.681702908845859;con11:-0.80094485823065,-0.0146838095970452;lin011:0.0448889152310232,0.654556943278632;lin111:-0.305570839058907,-0.171497561164085;sqr011:0.358727867186256,0.504604271224877;sqr111:0.535343679071775,0.54025648004106;lin012:-0.401543415290718,-0.320328845519674;lin112:0.301780722461925,-0.545245410731101;sqr012:-0.302119924908552,-0.0557302269134743;sqr112:0.182030509380673,0.682870932690447;con20:-0.423857063986361,-0.815499624703079;lin020:-0.00884737621880928,-0.075898750099586;lin120:0.423060469700329,-0.572989291906183;sqr020:-0.466518215591724,0.482401935729531;sqr120:-0.517395384035133,0.0939002825327981;con21:0.0600173375569284,-0.268467937596142;lin021:0.458156727669611,0.0781897223928257;lin121:0.561310011313282,-0.316403545540272;sqr021:0.512012066515057,0.390077071442478;sqr121:-0.223933576897786,-0.384102095804462;lin022:0.563102977103062,-0.502561941300977;lin122:-0.123404569081551,-0.444168995365868;sqr022:-0.282865790771775,0.240516261029842;sqr122:-0.517269996831541,-0.572250019719689]',
      'IFS[qualityfactor:50;Color00:0.391625553369522,0.962817132472992,0.358615726232529;Color01:0.391119331121445,0.955936968326569,0.355115860700607;Color02:0.390936970710754,0.958747208118439,0.359548300504684;Color10:0.660992622375488,0.631298959255219,0.752740442752838;Color11:0.657701313495636,0.632010340690613,0.754058957099915;Color12:0.657439589500427,0.626980245113373,0.747089207172394;Color20:0.0261834468692541,0.467489898204803,0.0421433821320534;Color21:0.028671357780695,0.46800971031189,0.0437432900071144;Color22:0.0303168520331383,0.467522233724594,0.0437664240598679;con00:0.232852810993791,-0.13682966073975;lin000:0.340899453591847,0.429015933981662;lin100:0.251398978039688,-0.510188981862933;sqr000:0.284569726941703,-0.111741975347938;sqr100:0.593103746612556,-0.132693803311253;con01:0.233537863839499,-0.132943214710403;lin001:0.342659685700022,0.425441054928132;lin101:0.247439208875784,-0.507228050470676;sqr001:0.282389299518924,-0.110027526521499;sqr101:0.585404776924519,-0.13725035714585;con02:0.237628677025351,-0.145191501395416;lin002:0.343845182083561,0.42038032377363;lin102:0.246216974237673,-0.498597061178999;sqr002:0.285419409749193,-0.103859885313842;sqr102:0.582970666108658,-0.132203533315057;con10:-0.810146624222398,-0.521768493577838;lin010:-0.413970281865253,-0.172145615387328;lin110:0.361883716518541,-0.409022576719957;sqr010:-0.279403284591719,-0.161996385909018;sqr110:-0.103950478112364,0.502961783842988;con11:-0.79928395650086,-0.515193051514677;lin011:-0.415326202348914,-0.1669082359086;lin111:0.353590343451395,-0.400728153021887;sqr011:-0.283216885809082,-0.163293730635801;sqr111:-0.0962870468815138,0.494892367731099;con12:-0.807521745101049,-0.510860959179202;lin012:-0.408674647560353,-0.172028800117439;lin112:0.3574212696531,-0.401396289495576;sqr012:-0.270099703381918,-0.159274941966754;sqr112:-0.0999224297249835,0.498931215372359;con20:-0.324557763524354,0.306000143755227;lin020:-0.274410105301785,-0.00657354320493442;lin120:0.702830664340303,0.680016380312182;sqr020:0.351682332290832,-0.227859173222216;sqr120:-0.525197319201159,-0.240956869781803;con21:-0.323508065599734,0.310910505426259;lin021:-0.271521616257248,-0.0038896538832343;lin121:0.697156360056884,0.672396896565246;sqr021:0.342635859997185,-0.230784763282641;sqr121:-0.517904463832747,-0.242192523134985;con22:-0.329359805439905,0.304855230634547;lin022:-0.272405129667946,-0.00698187091782728;lin122:0.692166990808696,0.677883409174544;sqr022:0.343559301461003,-0.229853091803898;sqr122:-0.517575047104746,-0.243669696526877]',
      'IFS[qualityfactor:50;Color00:0.342401713132858,0.675510704517365,0.349435895681381;Color01:0.747853696346283,0.741019606590271,0.450377523899078;Color02:0.140430361032486,0.433487147092819,0.818508505821228;Color10:0.342401713132858,0.675510704517365,0.349435895681381;Color11:0.912244558334351,0.33280935883522,0.103157609701157;Color12:0.140430361032486,0.433487147092819,0.818508505821228;Color20:0.342401713132858,0.675510704517365,0.349435895681381;Color21:0.882601201534271,0.298935115337372,0.987773478031158;Color22:0.140430361032486,0.433487147092819,0.818508505821228;con00:0.0667041819542646,0.971530163194984;lin000:-0.265867448163531,-0.226282568937812;lin100:-0.118820991633964,-0.504158538338099;sqr000:0.221658433051068,0.0399333197347042;sqr100:-0.580628724300146,0.684181945974782;con01:-0.648305970709771,-0.234324007760733;lin001:-0.60291211575844,-0.421831119227706;lin101:0.45187036584644,0.112835840166211;sqr001:-0.415090551684118,0.111624816657973;sqr101:0.070884091063435,-0.549942500836984;con02:0.397349197417498,-0.274059358984232;lin002:0.358276398047541,0.232586302177287;lin102:0.477994566682307,0.58691710686714;sqr002:-0.00687090041643541,-0.0000354655852051554;sqr102:-0.665188972479896,-0.1590525642007;con10:0.0667041819542646,0.971530163194984;lin010:-0.265867448163531,-0.226282568937812;lin110:-0.118820991633964,-0.504158538338099;sqr010:0.221658433051068,0.0399333197347042;sqr110:-0.580628724300146,0.684181945974782;con11:-0.740130817051977,-0.454416209831834;lin011:0.115562885486113,-0.106040500158805;lin111:0.390901470714069,0.187859753399612;sqr011:-0.595096513488968,-0.059974517950009;sqr111:0.629602629968312,0.473502466005962;con12:0.397349197417498,-0.274059358984232;lin012:0.358276398047541,0.232586302177287;lin112:0.477994566682307,0.58691710686714;sqr012:-0.00687090041643541,-0.0000354655852051554;sqr112:-0.665188972479896,-0.1590525642007;con20:0.0667041819542646,0.971530163194984;lin020:-0.265867448163531,-0.226282568937812;lin120:-0.118820991633964,-0.504158538338099;sqr020:0.221658433051068,0.0399333197347042;sqr120:-0.580628724300146,0.684181945974782;con21:0.152222840115428,-0.26731683453545;lin021:0.408784854994193,0.0444939179302294;lin121:0.289577984266692,0.00756775114135847;sqr021:0.448651872467833,-0.566604153345899;sqr121:0.325167765368425,-0.461829609844009;con22:0.397349197417498,-0.274059358984232;lin022:0.358276398047541,0.232586302177287;lin122:0.477994566682307,0.58691710686714;sqr022:-0.00687090041643541,-0.0000354655852051554;sqr122:-0.665188972479896,-0.1590525642007]',
      'IFS[qualityfactor:50;Color00:0.870003163814545,0.49747821688652,0.290991604328156;Color01:0.870003163814545,0.49747821688652,0.290991604328156;Color02:0.870003163814545,0.49747821688652,0.290991604328156;Color10:0.834248900413513,0.956327974796295,0.796185910701752;Color11:0.834248900413513,0.956327974796295,0.796185910701752;Color12:0.834248900413513,0.956327974796295,0.796185910701752;Color20:0.475307136774063,0.147468417882919,0.0195140466094017;Color21:0.475307136774063,0.147468417882919,0.0195140466094017;Color22:0.475307136774063,0.147468417882919,0.0195140466094017;con00:-0.0090218260884285,-0.629961667116731;lin000:-0.0065771467604821,0.437024789758996;lin100:0.532907370944708,0.623192417984431;sqr000:-0.515282719252875,-0.541039874051044;sqr100:-0.503048428873175,-0.633583703728457;con01:-0.0090218260884285,-0.629961667116731;lin001:-0.0065771467604821,0.437024789758996;lin101:0.532907370944708,0.623192417984431;sqr001:-0.515282719252875,-0.541039874051044;sqr101:-0.503048428873175,-0.633583703728457;con02:-0.0090218260884285,-0.629961667116731;lin002:-0.0065771467604821,0.437024789758996;lin102:0.532907370944708,0.623192417984431;sqr002:-0.515282719252875,-0.541039874051044;sqr102:-0.503048428873175,-0.633583703728457;con10:-0.458186278119683,-0.330401349812746;lin010:-0.155048142732842,-0.228188532404083;lin110:-0.0162999841456695,0.430169201819461;sqr010:-0.347819957226985,-0.418119503440982;sqr110:-0.214460634762864,0.194408518208889;con11:-0.458186278119683,-0.330401349812746;lin011:-0.155048142732842,-0.228188532404083;lin111:-0.0162999841456695,0.430169201819461;sqr011:-0.347819957226985,-0.418119503440982;sqr111:-0.214460634762864,0.194408518208889;con12:-0.458186278119683,-0.330401349812746;lin012:-0.155048142732842,-0.228188532404083;lin112:-0.0162999841456695,0.430169201819461;sqr012:-0.347819957226985,-0.418119503440982;sqr112:-0.214460634762864,0.194408518208889;con20:0.267470188904554,0.310343902092427;lin020:0.687767884139786,0.239016451596147;lin120:-0.692182687825234,0.185815320743098;sqr020:0.699088513161833,-0.411887443222306;sqr120:0.61940099845714,0.41411456139369;con21:0.267470188904554,0.310343902092427;lin021:0.687767884139786,0.239016451596147;lin121:-0.692182687825234,0.185815320743098;sqr021:0.699088513161833,-0.411887443222306;sqr121:0.61940099845714,0.41411456139369;con22:0.267470188904554,0.310343902092427;lin022:0.687767884139786,0.239016451596147;lin122:-0.692182687825234,0.185815320743098;sqr022:0.699088513161833,-0.411887443222306;sqr122:0.61940099845714,0.41411456139369]',
      'IFS[qualityfactor:50;Color00:0.616901278495789,0.305223345756531,0.687214493751526;Color01:0.603518605232239,0.96046906709671,0.220560863614082;Color02:0.792852401733398,0.24973963201046,0.014457518234849;Color10:0.616901278495789,0.305223345756531,0.687214493751526;Color11:0.827264130115509,0.280047118663788,0.700148701667786;Color12:0.792852401733398,0.24973963201046,0.014457518234849;Color20:0.616901278495789,0.305223345756531,0.687214493751526;Color21:0.222109004855156,0.727055609226227,0.940873861312866;Color22:0.792852401733398,0.24973963201046,0.014457518234849;con00:-0.447096879128367,-0.635228424333036;lin000:-0.539513657311852,0.0239209433783672;lin100:-0.0463361362637608,0.541451684980944;sqr000:0.424138485327927,0.378654641976209;sqr100:0.467105274105548,-0.00403996443204298;con01:-0.410815946292132,0.549998038914055;lin001:-0.259453819980014,-0.529945458360212;lin101:0.00619955643739554,0.631170012653971;sqr001:0.381699492643858,-0.0569251865455285;sqr101:-0.290497017701168,0.261228657027306;con02:-0.985996008384973,-0.247198923956603;lin002:-0.013381179884666,0.0910258160978835;lin102:-0.266156992402989,-0.485445388307189;sqr002:0.0766516525110338,0.669510842364377;sqr102:0.123052630054867,0.312391842875061;con10:-0.447096879128367,-0.635228424333036;lin010:-0.539513657311852,0.0239209433783672;lin110:-0.0463361362637608,0.541451684980944;sqr010:0.424138485327927,0.378654641976209;sqr110:0.467105274105548,-0.00403996443204298;con11:0.421241620089859,-0.557881575543433;lin011:-0.126282513619285,-0.433813943069944;lin111:-0.0213855285833875,-0.0417052394298252;sqr011:-0.408419726638103,-0.607455399501761;sqr111:-0.158656877403807,0.157224379450634;con12:-0.985996008384973,-0.247198923956603;lin012:-0.013381179884666,0.0910258160978835;lin112:-0.266156992402989,-0.485445388307189;sqr012:0.0766516525110338,0.669510842364377;sqr112:0.123052630054867,0.312391842875061;con20:-0.447096879128367,-0.635228424333036;lin020:-0.539513657311852,0.0239209433783672;lin120:-0.0463361362637608,0.541451684980944;sqr020:0.424138485327927,0.378654641976209;sqr120:0.467105274105548,-0.00403996443204298;con21:0.744156579021364,-0.867402885109186;lin021:-0.139221755150628,-0.0557744070181535;lin121:0.504417567271418,0.362771765433917;sqr021:0.227955781042993,0.356141066821862;sqr121:-0.0393403540766431,0.678035701020214;con22:-0.985996008384973,-0.247198923956603;lin022:-0.013381179884666,0.0910258160978835;lin122:-0.266156992402989,-0.485445388307189;sqr022:0.0766516525110338,0.669510842364377;sqr122:0.123052630054867,0.312391842875061]'];

interpolateY(Y,Y,Y,Y,tau)->Y;
interpolateY(Y_0,Y_1,Y_2,Y_3,tau)->
  Y_0*(tau*(-0.5+(1-tau*0.5)*tau))   +
  Y_1*(1+tau*tau*(-2.5+(3*tau)*0.5)) +
  Y_2*(tau*(0.5+(2-(3*tau)*0.5)*tau))+
  Y_3*((-0.5+tau*0.5)*tau*tau)       ;

quadWorkflowAt(t)->begin
  local it:=floor(t);
  local dt:=t-it;
  local A1:=IFS[min(IFS.size-1,max(0,it-1))].splitData;
  local A2:=IFS[min(IFS.size-1,max(0,it  ))].splitData;
  local A3:=IFS[min(IFS.size-1,max(0,it+1))].splitData;
  local A4:=IFS[min(IFS.size-1,max(0,it+2))].splitData;
  local result:=[['algorithm',A1['algorithm']]].toMap;
  local parameterKeys:=A1['parameters'].getInner(0);
//  A2['parameters'].getInner(0)==parameterKeys AND
//  A3['parameters'].getInner(0)==parameterKeys AND
//  A4['parameters'].getInner(0)==parameterKeys ? void : fail('Wha? ',t);
  result['parameters']:=parameterKeys.each(key,
    [key,interpolateY(A1['parameters',key] orElse 0.0,
                      A2['parameters',key] orElse 0.0,
                      A3['parameters',key] orElse 0.0,
                      A4['parameters',key] orElse 0.0,dt)]).toMap;
  result.joinData;
end;


splitParameter(s:String)->split(s,',').join(',')==s
  ? split(s,',').softCast
  : s.softCast;

splitData(s:String)->pos('[',s)>0 AND pos(']',s)+1=s.length ? begin
  local algorithm:=split(s,'[')[0];
  local parameters:=split(s,['[',']'])[1].split(";").map({$x.split(":")}).map({[$x[0],$x[1].splitParameter]}).toMap;
  [['algorithm',algorithm],
   ['parameters',parameters]].toMap;
end : s;

joinParameter(n:NumericList)->n.join(',');
joinParameter(s)->s;

joinData(m:Map)->m['algorithm']&'['&(m['parameters'].map({($x[0])&':'&($x[1].joinParameter)}).join(";"))&']';
joinData(s:String)->s;
//
//interpolate(a:Real,b:Real,t)->a*(1-t)+b*t;
//interpolate(a:NumericList(2),b:NumericList(2),t)->a*(1-t)+b*t;
//interpolate(a:NumericList(3),b:NumericList(3),t)->a*(1-t)+b*t;
//interpolate(a:Int           ,b:Int           ,t)->round(a*(1-t)+b*t);
//interpolate(a:IntList(1)    ,b:IntList(1)    ,t)->round(a*(1-t)+b*t);
//
//interpolateGeneration(g1:String,g2:String,t:Numeric)->begin
//  local G1:=g1.splitData;
//  local G2:=g2.splitData;
//  G1.isMap AND G2.isMap AND G1['algorithm']==G2['algorithm']
//  ? void
//  : fail('Cannot interpolate between ',G1['algorithm'],' and ',G2['algorithm']);
//  [['algorithm',G1['algorithm']],
//   ['parameters',mergeMaps(G1['parameters'],G2['parameters'],{interpolate($x,$y,t)})]].toMap.joinData;
//end;


FRAMES_BETWEEN:=200;

main->random((IFS.size+1)*FRAMES_BETWEEN).sortPerm.pEach(imageIndex,begin
  local filename:=format('C:\dev\data\ifs_int_%4.4d.jpg',imageIndex);
  print(filename);
  fileExists(filename)
  ? void
  : [quadWorkflowAt(imageIndex/FRAMES_BETWEEN-1)].executeWorkflow(1920,1080,filename);
end);
